---
tags:
  - мм_тема
  - мм_метод
---
[[Математические методы планирования и интерпретации эксперимента]]  
Prev Theme: [[Критерии выбора модели регрессии]]  
Next Theme: [[Робастное оценивание]]

---
### Постановка задачи (и описание проблемы)
...

### Метод скользящего интервала
$$
y(t_{i+p}) = \eta(t_{i+p}) + \epsilon_{i+p}, \, p = -m, \dots, m,
$$
где $2m + 1$ — размер окна скользящего интервала, $i$ - его центр.

Истинный сигнал $\eta(t)$ моделируется полиномом степени $k-1$:
$$
\eta(t) = \sum_{j=1}^k b_{j-1}(t - t_i)^{j-1} = Xb,
$$
где параметры $b_{j-1}$ нужно определить. Здесь матрица $X$ есть
$$
X =
\begin{pmatrix}
1 & -m\Delta & \dots & (-m\Delta)^{k-1} \\
\vdots & \vdots & \ddots & \vdots \\
1 & 0 & \dots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
1 & m\Delta & \dots & (m\Delta)^{k-1}
\end{pmatrix},
$$
где $\Delta$ — шаг времени между соседними точками, а $2m + 1$ — число строк (размер окна).

Параметры $\hat{b}$ находятся [[Метод наименьших квадратов (МНК)|методом наименьших квадратов]]:
$$
\hat{b} = (X'X)^{-1}X'Y,
$$
### Сглаженное значение регрессии

Сглаженное значение в точке $t_i$ совпадает с коэффициентом $\hat{b}_0$ полинома (просто потому что остальные члены обнуляются при подстановке $t = t_{i}$):
$$
\hat{x}(t_i) = \hat{b}_0.
$$
Это формально записывается через матрицу $T_{0}$:
$$
T_{0} = (1 \, 0 \, \dots \, 0), \quad \hat{x}(t_i) = T_{0}\hat{b}.
$$
Подставляя $\hat{b}$, получаем:
$$
\hat{x}(t_i) = T_{0}(X'X)^{-1}X'Y = T_{0}LY,
$$
где $L$ — весовая матрица, зависящая только от матрицы $X$ (размерности $1 \times (2m + 1)$).

### Сглаженная производная регрессии
Для поиска производной $\hat{x}'(t_i)$ применяется аналогичный подход: производная в точке $t_i$ равна первому коэффициенту полинома $\hat{b}_1$:
$$
\hat{x}'(t_i) = T_{1}\hat{b} = T_{1}(X'X)^{-1}X'Y = T_{1}LY
$$
где
$$
T_{1} = (0 \, 1 \, 0 \, \dots \, 0).
$$
### Замечания
0. Заметим, что матрица $L$ вообще не зависит от расположения скользящего интервала. Это означает, что её можно вычислить один раз и применять на всём наборе данных.
1. Существует $m$ оптимальное
2. Выбор степени полинома - это выбор модели регрессии. Можно произвести с помощью [[Критерии выбора модели регрессии|критерия Акаики]] 
3. Сплайн-сглаживание
4. Фурье-сглаживание
5. Решение задачи в спектральной области
