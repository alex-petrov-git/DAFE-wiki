---
tags:
  - мм_тема
---
[[Математические методы планирования и интерпретации эксперимента]]  
Prev Theme: [[Обобщённый МНК]]  
Next Theme: [[Критерии выбора модели регрессии]]  

---
Определить все факторы, влияющие на целевую величину $y$, на практике часто сложно. Можно упустить значимые факторы или, напротив, включить в модель те, которые на самом деле не оказывают влияния. Рассмотрим два упрощённых сценария:
1. **Перебор**: в модель включены _все_ значимые факторы, а также _некоторые_ лишние, не влияющие на $y$.
2. **Недобор**: в модель включены только _некоторые_ значимые факторы, то есть учтены не все.
Для анализа этих случаев мы будем исходить из предположения, что истинные влияющие и не влияющие факторы заранее известны. В реальных задачах это, разумеется, не так, и их идентификация является ключевой задачей исследователя. Тем не менее, целью нашего анализа является не решение конкретной прикладной задачи, а общее понимание того, как недобор или перебор факторов влияет на оценки параметров регрессии. Полученные выводы затем могут быть использованы для выбора значимых факторов в конкретных практических ситуациях.

Напомним, что [[Постановка задачи классической линейной регрессии (КЛР)|истинная регрессия]] имеет вид
$$
Y = Xb + \epsilon
$$
### Перебор факторов регрессии
В этом случае регрессия имеет вид
$$
y_{i} = \sum\limits_{j=1}^k \delta_{j}x_{ij} + \sum\limits_{j=1}^m \phi_{j}p_{ij} + \epsilon_{i},\ i = \overline{1,n}
$$
Или в матричном виде
$$
Y = Z \alpha + \epsilon,\ Z = (X|P),\ \alpha = \left(\dfrac{\delta}{\phi}\right)
$$
Оценка МНК этой линейной регрессии
$$
\hat{\alpha} = (Z'Z)^{-1}Z'Y
$$
#### Свойства оценки МНК в случае перебора
1. Несмещённость: $E(\hat{\alpha}) = \left(\dfrac{b}{0}\right)$
2. Оценка дисперсии: $\hat{\sigma}^2 = \dfrac{(Y - Z\hat{\alpha})'(Y - Z\hat{\alpha})}{n-k-m}$
3. Состоятельность: $\hat{\alpha} \to \left(\dfrac{b}{0}\right),\ n\to \infty$
4. Дисперсия: 
$$
D(\hat{\delta}) = D(\hat{b}) + \sigma^2 \underbrace{(X'X)^{-1}X'PE^{-1}P'X(X'X)^{-1}}_{\geq 0}
$$где $E = P'P - P'X(X'X)^{-1}X'P = P'BP$. То есть, **при переборе дисперсия увеличивается**. Однако, если $X'P=0$, то есть если не влияющие параметры ортогональны влияющим (не коррелируют с ними), то $D(\hat{\delta}) = D(\hat{b})$.
### Недобор факторов регрессии

В случае недобора регрессия имеет вид:  
$$
y_{i} = \sum\limits_{j=1}^r \gamma_{j} x_{ij} + \epsilon_{i}, \ i = \overline{1,n}, \ r < k  
$$
Или в матричном виде:  
$$
Y = W \gamma + \epsilon, \ W = X_1, \ \gamma = b_1  
$$
где $X_1$ — матрица из первых $r$ столбцов матрицы $X$, соответствующих выбранным факторам, а $b_1$ — часть вектора $b$, соответствующая этим факторам.  
#### Свойства оценки МНК в случае недобора
1. **Смещённость**:  $$  
E(\hat{\gamma}) = b_1 + (X_1'X_1)^{-1}X_1'X_2 b_2  
$$где $X_2$ — матрица, составленная из пропущенных факторов, а $b_2$ — соответствующая часть истинного вектора коэффициентов.  Таким образом, оценка $\hat{\gamma}$ будет смещённой, если пропущенные факторы $X_2$ коррелируют с учтёнными $X_1$.  
2. **Дисперсия оценки**:  $$  
D(\hat{\gamma}) = \sigma^2 (X_1'X_1)^{-1}  
$$При недоборе дисперсия может быть занижена по сравнению с дисперсией оценки при учёте всех факторов.  
3. **Несостоятельность**:  
   Если $X_2$ коррелируют с $X_1$, то при $n \to \infty$, $\hat{\gamma}$ не сходится к истинному значению $b_1$, так как остаётся систематическая ошибка, вызванная пропущенными факторами.    
### Вывод
Недобор факторов приводит к более серьёзным проблемам, чем перебор, так как вызывает смещение оценки, делая модель систематически неверной. В практических задачах важно учитывать потенциальные пропущенные факторы, используя либо априорные знания, либо методы регуляризации и анализа остаточной корреляции.  
