---
tags:
  - мм_тема
  - тема
---
[[Математические методы планирования и интерпретации эксперимента]]  
Prev Theme: [[Робастное оценивание]]  
Next Theme: [[Ошибки в факторах регрессии]]

---
### Проблема плохой обусловленности
В случае [[Обусловленность матрицы|плохой обусловленности матрицы]] $X'X$ оценка МНК будет иметь очень большую дисперсию, так как
$$
D(\hat{b}) = \sigma^2 (X'X)^{-1}
$$
#### Пример (чтобы "пощупать")
...
Существуют методы, позволяющие решать эту проблему и получить оценку с конечной дисперсией, но уже смещённую - такую, чтобы по [[Критерий сравнения оценок|критерию качества]] она была лучше оценки МНК.
### Ридж-регрессия
**добавить обоснование её выбора и свойства**
Ридж-регрессия — это метод, изменяющий систему нормальных уравнений МНК так, чтобы улучшить обусловленность её матрицы:
$$
(X'X + \kappa I)\hat{b} = X'Y
$$
где $\kappa$ некоторый параметр. Тогда оценка параметров регрессии:
$$
\hat{b}(\kappa) = (X'X + \kappa I)X'Y
$$
Существует $\kappa_{опт}$ оптимальное значение, при котором дисперсия оценки $\hat{b}$ минимальна. Её можно определить построив зависимость 
$$
\hat{\sigma}^2(\kappa) = \dfrac{J(\hat{b}(\kappa))}{n-k}
$$
Эта зависимость при малых $\kappa>0$ имеет примерно постоянное значение и при некотором $\kappa=\kappa_{опт}$ резко начинает расти с увеличением $\kappa$. Это чисто прикладной метод определения $\kappa_{опт}$, аналитических нет. 
### Методы с априорными ограничениями
В некоторых случаях мы можем располагать дополнительной информацией о параметрах модели. Например, мы можем знать, что $b$ не сильно отличаются от какого-то априорного значения $b_0$. Ограничение может быть задано в виде эллипсоида:
$$
\mathscr{B} = \{ b : (b_0 - b)'B(b_0 - b) < c \},
$$
где:
- $B$ — матрица, определяющая форму эллипсоида,
- $c > 0$ — параметр, задающий размер эллипсоида.
Это множество включает все параметры $b$, которые находятся в определённой доверительной области вокруг $b_0$.

То есть мы можем искать оценку параметров $b$ не из всех возможных значений, а из множества $\mathscr{B}$.

**(объяснение выбора критерия r(b, $\tilde{b}$))**
$$
\hat{b} = \arg\min_{\tilde{b} \in \mathscr{B}} \max_{b \in \mathscr{B}} r(b, \tilde{b}),
$$
где:
$$
r(b, \tilde{b}) = a'E[(b - \tilde{b})(b - \tilde{b})']a.
$$
Решение имеет вид:
$$
\hat{b} = \left( \frac{\sigma^2}{c} B + X'W^{-1}X \right)^{-1} X'W^{-1} (Y - Xb_0) + b_0,
$$
Если мы зададим априорное среднее $b_0 = 0$, сферическое множество ($B = I$) и примем, что ошибки независимы ($W = I$), то задача сводится к ридж-регрессии:
$$
\hat{b} = (X'X + kI)^{-1}X'Y,
$$
где $k = \frac{\sigma^2}{c}$.
